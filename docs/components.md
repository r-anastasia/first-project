# Организация компонентов

## generic компоненты

Компоненты, которые часто переиспользуются на сайте (такие как кнопки, чекбоксы,
карточка пользователя, лоадер и т.д.) следует выносить в отдельную папку
`src/components/generic`. Важно понимать, что такие компоненты не могут быть
подписаны на стор и должны быть чистыми функциями. Т.е. при передаче
одинаковых параметрах (`props`) компонент должен возвращать один и тот же
результат не зависимо от его фактичесго расположения или, например, состояния
стора. Исключения, конечно, возможны. Например такой компонент может быть
подписан на текущую локаль с помощью `useTranslation` и принимать пропсом
ключ для перевода `someI18nKey`. Важно понимать какое исключение из правил
допустимо, а какое нет. Кроме того код такого компонента не может зависить
от кода компонентов из вне (в компоненте не должно быть импортов из соседних
компонентов и тем более из уникальных компонентов НЕ из папки `generic`).
Иными словами - компонент ничего не должен знать о внешнем мире и быть
максимально изолирован.

## shared компоненты

Когда возникает потребность в переиспользуемом компоненте, но который
использует `generic` компоненты, подписку на стор или `SWR`, а также  
содержит какую-то логику любой сложности, его следует расположить  
в папке `src/components/shared`.

## Страницы

В `next.js` приложении роутинг завязан на файловую систему. В частности на все
файлы и папки внутри `src/pages` будут сгенерированы роуты (в том числе
динамические). По этой причине внутри этой папки не доступна декомпозиция
компонента страницы на файлы и папке. В таком случае удобно хранить страницы
в `src/components/pages` и иметь возможность декомпозировать на любые
подкомпоненты, выность типы и стили в отдельные папки. Внутри непосредственно
`src/pages` просто экспортить из `src/components/pages`
(в том числе `getServerSideProps` или `getStaticProps`). Таким образом
код страницы в `src/pages` будут выглядеть так:

```ts
export { SomePage, getServerSideProps } from 'src/components/pages/SomePage'
```

## Декомпозиция компонентов

Удобно под каждый компонент иметь некоторую бойлерплейтную структуру.
Если компонент называется `SomeComponent`, то следуют завести под него
отдельную папку и назвать ее `SomeComponent`, а внутри расположить файлики:

- `SomeComponent.tsx` который будет содержать непосредственно сам компонент
- `styles.ts` в котором будут все стили этого компонента
- `types.ts` куда складываются все типы этого компонента
- `hooks.ts` где будут лежать кастомные хуки этого компонента
- `index.ts` откуда все выше будет экспортироваться по необходимости (как
  минимум сам компонент)

Кроме того внутри компонента допустимо создать папочку `assets` куда можно
расположить всякие `fixtures.ts`, изображения или `mock.ts` (но лучше моков
избегать, и дожидаться настоящей реализации на бокендах).
Если, к примеру, типов или стилей не предполагается компонентом, то пустые
файлы создавать не нужно.

## Декомпозиция компонента на более мелкие отдельные компоненты

В случае если компонент получается слишком сложный (более 100 строк кода это
уже повод задуматься над дальнейшей декомпозицией), то можно разделить этот
компонент на более мелкие компоненты. Эти компоненты следует располгать в папке
родительского компонента тем самым повторяя древовидную структуру компонентов
непосредственно в дереве реакта. Это наглядно и удобно т.к. сразу понятно, что
компонент использует другие уникальные компоненты и что они используются только
внутри этого компонента.

Например есть некоторый компонент `SomeCompoent` с вкладками.
Возможно (а возможно и нет), будет удобно вынести вкладки в отдельные уникальные
компоненты и расположить непосредственно в директории компонента
`SomeCompoent/FirstTab` и `SomeComponent/SecondTab`. В свою очередь кладки
могут быть декомпозированы на еще более мелкие компоненты, например
`SomeCompoent/FirstTab/SomeBlock`. Вложеность может быть любого уровня.
Кроме того на каждом из уровней допустимо использовать какие-то `generic`
компоненты или `shared` компоненты. Важно понимать, что из примера выше
компонент `SomeComponent/FirstTab/SomeBlock` не может использоваться ни при
каких обстоятельствах в соседней ветке (например импортиться в
компоненте `SomeComponent/SecondBlock`). Т.е. компонент с большей вложенностью
всегда используется только компонентом в папку которого он вложен.
